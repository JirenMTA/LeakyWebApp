CREATE USER server WITH PASSWORD 'SuperSecretPass123!' NOINHERIT;
CREATE ROLE server_role;
CREATE database "LeakyWebApp";
ALTER DATABASE "LeakyWebApp" OWNER TO server;
GRANT SELECT, INSERT, UPDATE, DELETE ON ALL TABLES IN SCHEMA "public" TO server_role;
REVOKE ALL ON ALL TABLES IN SCHEMA information_schema FROM server_role;
REVOKE ALL ON ALL TABLES IN SCHEMA information_schema FROM server;
REVOKE ALL ON ALL TABLES IN SCHEMA information_schema FROM PUBLIC;
REVOKE ALL PRIVILEGES ON SCHEMA public FROM PUBLIC;
REVOKE CONNECT ON DATABASE postgres FROM server_role;
REVOKE CONNECT ON DATABASE postgres FROM server;
REVOKE CONNECT ON DATABASE postgres FROM PUBLIC;
GRANT CONNECT ON DATABASE "LeakyWebApp" TO server_role;
GRANT server_role TO server;